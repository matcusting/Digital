<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>å¿ƒç†è¾…å¯¼ç³»ç»Ÿ - æ³¨å†Œ</title>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      
      /* ğŸŒŠ åŠ¨æ€æ¸å˜èƒŒæ™¯ */
      background: linear-gradient(-45deg, #a18cd1, #fbc2eb, #a6c1ee, #96e6a1);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .register-box {
      width: 320px;
      text-align: center;
      padding: 40px;
      
      /* âœ¨ æ¯›ç»ç’ƒæ•ˆæœ */
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
    }

    h2 { color: #4a5568; margin-bottom: 25px; }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-sizing: border-box;
    }

    button {
      background: #2ecc71;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #27ae60; }

    a { color: #3498db; text-decoration: none; }
    a:hover { text-decoration: underline; }

    .privacy-text {
      font-size: 12px; 
      color: #666; 
      text-align: left; 
      margin-top: 5px;
    }
    
    .teacher-key-group {
        width: 100%;
        margin: 10px 0;
        text-align: left;
    }
  </style>
</head>
<body>
  <div class="register-box">
    <div class="lang-switch">
      ğŸŒ 
      <button onclick="setLanguage('zh')" style="width:auto; background:none; color:#3498db; padding:0;">ä¸­æ–‡</button> | 
      <button onclick="setLanguage('en')" style="width:auto; background:none; color:#3498db; padding:0;">English</button> | 
      <button onclick="setLanguage('ms')" style="width:auto; background:none; color:#3498db; padding:0;">Bahasa</button>
    </div>

    <h2 id="title">æ³¨å†Œæ–°è´¦æˆ·</h2>
    
    <select id="role" onchange="checkRole()">
      <option value="student">å­¦ç”Ÿ Student</option>
      <option value="teacher">è€å¸ˆ Teacher</option>
    </select>
    
    <input type="text" id="username" placeholder="åˆ›å»ºç”¨æˆ·å / Username">
    <input type="password" id="password" placeholder="è®¾ç½®å¯†ç  / Password">
    <input type="password" id="confirm" placeholder="ç¡®è®¤å¯†ç  / Confirm password">
    
    <div id="teacherKeyGroup" class="teacher-key-group" style="display:none;">
        <label id="labelTeacherKey" for="teacherKey" style="font-weight:bold; font-size:14px; color:#555;">è€å¸ˆæ³¨å†Œç :</label>
        <input type="password" id="teacherKey" placeholder="è¾“å…¥è€å¸ˆæ³¨å†Œç ...">
    </div>

    <p id="privacyText" class="privacy-text">
      ğŸ”’ æ‚¨çš„æ‰€æœ‰ä¿¡æ¯å°†ä»…å­˜å‚¨åœ¨æ‚¨å½“å‰çš„æµè§ˆå™¨ä¸­ï¼Œä¸ä¼šä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚
    </p>

    <button id="registerBtn" onclick="register()">æ³¨å†Œ / Register</button>
    <p id="msg" style="color: #e74c3c; font-size: 14px;"></p>
    <p id="loginText" style="margin-top: 15px; font-size: 14px;">å·²æœ‰å¸å·ï¼Ÿ<a href="index.html">è¿”å›ç™»å½•</a></p>
  </div>

  <script>
    const TEACHER_KEY = "Admin123";

    const langText = {
      zh: {
        title: "æ³¨å†Œæ–°è´¦æˆ·", username: "åˆ›å»ºç”¨æˆ·å / Username", password: "è®¾ç½®å¯†ç  / Password", confirm: "ç¡®è®¤å¯†ç  / Confirm password",
        register: "æ³¨å†Œ / Register", empty: "ç”¨æˆ·åä¸å¯†ç ä¸èƒ½ä¸ºç©ºï¼", mismatch: "ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´ï¼", exists: "ç”¨æˆ·åå·²å­˜åœ¨ï¼", success: "æ³¨å†ŒæˆåŠŸï¼æ­£åœ¨è·³è½¬...",
        login: "å·²æœ‰å¸å·ï¼Ÿ", login_link: "è¿”å›ç™»å½•",
        privacy: "ğŸ”’ æ‚¨çš„æ‰€æœ‰ä¿¡æ¯å°†ä»…å­˜å‚¨åœ¨æ‚¨å½“å‰çš„æµè§ˆå™¨ä¸­ï¼Œä¸ä¼šä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚",
        teacher_key_label: "è€å¸ˆæ³¨å†Œç :", teacher_key_placeholder: "è¾“å…¥è€å¸ˆæ³¨å†Œç ...", teacher_key_invalid: "è€å¸ˆæ³¨å†Œç æ— æ•ˆï¼"
      },
      en: {
        title: "Register New Account", username: "Create Username", password: "Set Password", confirm: "Confirm Password",
        register: "Register", empty: "Username and password cannot be empty!", mismatch: "Passwords do not match!", exists: "Username already exists!", success: "Registration successful! Redirecting...",
        login: "Already have an account?", login_link: "Back to login",
        privacy: "ğŸ”’ All your information will be stored only in your current browser and will not be uploaded to the server.",
        teacher_key_label: "Teacher Key:", teacher_key_placeholder: "Enter teacher key...", teacher_key_invalid: "Invalid Teacher Key!"
      },
      ms: {
        title: "Daftar Akaun Baru", username: "Nama Pengguna", password: "Kata Laluan", confirm: "Sahkan Kata Laluan",
        register: "Daftar", empty: "Nama pengguna dan kata laluan tidak boleh kosong!", mismatch: "Kata laluan tidak sepadan!", exists: "Nama pengguna sudah wujud!", success: "Pendaftaran berjaya! Sedang alih...",
        login: "Sudah ada akaun?", login_link: "Kembali log masuk",
        privacy: "ğŸ”’ Semua maklumat anda akan disimpan hanya dalam pelayar anda dan tidak akan dimuat naik ke pelayan.",
        teacher_key_label: "Kunci Guru:", teacher_key_placeholder: "Masukkan kunci guru...", teacher_key_invalid: "Kunci Guru tidak sah!"
      }
    };

    function checkRole() {
        const role = document.getElementById("role").value;
        const keyGroup = document.getElementById("teacherKeyGroup");
        keyGroup.style.display = role === 'teacher' ? 'block' : 'none';
    }

    function setLanguage(lang) {
      localStorage.setItem("lang", lang);
      const t = langText[lang];
      document.getElementById("title").innerText = t.title;
      document.getElementById("username").placeholder = t.username;
      document.getElementById("password").placeholder = t.password;
      document.getElementById("confirm").placeholder = t.confirm;
      document.getElementById("registerBtn").innerText = t.register;
      // *** é“¾æ¥ä¿®æ”¹ï¼šä» login.html æ”¹ä¸º index.html ***
      document.getElementById("loginText").innerHTML = `${t.login} <a href='index.html'>${t.login_link}</a>`;
      document.getElementById("privacyText").innerText = t.privacy;
      document.getElementById("labelTeacherKey").innerText = t.teacher_key_label;
      document.getElementById("teacherKey").placeholder = t.teacher_key_placeholder;
    }

    function register() {
      const lang = localStorage.getItem("lang") || "zh";
      const t = langText[lang];
      const role = document.getElementById("role").value;
      const user = document.getElementById("username").value.trim();
      const pass = document.getElementById("password").value.trim();
      const confirm = document.getElementById("confirm").value.trim();
      const msg = document.getElementById("msg");

      if (!user || !pass) { msg.innerText = t.empty; return; }
      if (pass !== confirm) { msg.innerText = t.mismatch; return; }

      if (role === 'teacher') {
          const teacherKeyInput = document.getElementById("teacherKey").value.trim();
          if (teacherKeyInput !== TEACHER_KEY) {
              msg.innerText = t.teacher_key_invalid; return;
          }
      }

      let users = JSON.parse(localStorage.getItem("users") || "[]");
      if (users.some(u => u.username === user)) { msg.innerText = t.exists; return; }

      const obfuscatedPassword = btoa(pass); 
      users.push({ username: user, password: obfuscatedPassword, role });
      localStorage.setItem("users", JSON.stringify(users));

      msg.style.color = "#27ae60";
      msg.innerText = t.success;
      // *** é“¾æ¥ä¿®æ”¹ï¼šä» login.html æ”¹ä¸º index.html ***
      setTimeout(() => window.location.href = "index.html", 1500);
    }

    const currentLang = localStorage.getItem("lang") || "zh";
    setLanguage(currentLang);
    checkRole();
  </script>
</body>
</html>
